{"version":3,"file":"ColorInput.js","sources":["../../../src/components/ColorInput/ColorInput.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useUncontrolled, useReducedMotion, useDidUpdate, useId } from '@mantine/hooks';\nimport { DefaultProps, getSizeValue, mergeStyles, useMantineTheme } from '../../theme';\nimport {\n  InputWrapper,\n  InputWrapperBaseProps,\n  InputWrapperStylesNames,\n} from '../InputWrapper/InputWrapper';\nimport { Input, InputBaseProps, InputStylesNames } from '../Input/Input';\nimport { ColorSwatch } from '../ColorSwatch/ColorSwatch';\nimport { Popper } from '../Popper/Popper';\nimport { MantineTransition } from '../Transition/Transition';\nimport { Paper } from '../Paper/Paper';\nimport {\n  ColorPicker,\n  ColorPickerBaseProps,\n  ColorPickerStylesNames,\n} from '../ColorPicker/ColorPicker';\nimport { convertHsvaTo, isColorValid, parseColor } from '../ColorPicker/converters';\nimport useStyles from './ColorInput.styles';\n\nexport type ColorInputStylesNames =\n  | InputWrapperStylesNames\n  | InputStylesNames\n  | ColorPickerStylesNames\n  | keyof ReturnType<typeof useStyles>;\n\nexport interface ColorInputProps\n  extends InputWrapperBaseProps,\n    InputBaseProps,\n    ColorPickerBaseProps,\n    DefaultProps<ColorInputStylesNames>,\n    Omit<React.ComponentPropsWithoutRef<'input'>, 'size' | 'onChange' | 'defaultValue' | 'value'> {\n  /** Disallow free input */\n  disallowInput?: boolean;\n\n  /** call onChange with last valid value onBlur */\n  fixOnBlur?: boolean;\n\n  /** Dropdown element z-index */\n  dropdownZIndex?: number;\n\n  /** Display swatch with color preview on the left side of input */\n  withPreview?: boolean;\n\n  /** Dropdown transition name or object */\n  transition?: MantineTransition;\n\n  /** Dropdown appear/disappear transition duration in ms */\n  transitionDuration?: number;\n\n  /** Dropdown transition timing function, defaults to theme.transitionTimingFunction */\n  transitionTimingFunction?: string;\n}\n\nconst SWATCH_SIZES = {\n  xs: 16,\n  sm: 18,\n  md: 22,\n  lg: 28,\n  xl: 36,\n};\n\nconst ARROW_OFFSET = {\n  xs: 12,\n  sm: 15,\n  md: 17,\n  lg: 21,\n  xl: 25,\n};\n\nexport function ColorInput({\n  label,\n  description,\n  error,\n  required,\n  wrapperProps,\n  size = 'sm',\n  format = 'hex',\n  onChange,\n  onFocus,\n  onBlur,\n  value,\n  defaultValue,\n  classNames,\n  styles,\n  themeOverride,\n  disallowInput = false,\n  fixOnBlur = true,\n  withPreview = true,\n  swatchesPerRow = 10,\n  withPicker = true,\n  icon,\n  transition = 'pop-top-left',\n  id,\n  dropdownZIndex = 1,\n  transitionDuration = 0,\n  transitionTimingFunction,\n  className,\n  style,\n  swatches,\n  ...others\n}: ColorInputProps) {\n  const theme = useMantineTheme(themeOverride);\n  const classes = useStyles({ theme }, classNames, 'color-input');\n  const _styles = mergeStyles(classes, styles);\n  const uuid = useId(id);\n  const [referenceElement, setReferenceElement] = useState<HTMLDivElement>(null);\n  const [dropdownOpened, setDropdownOpened] = useState(false);\n  const [lastValidValue, setLastValidValue] = useState('');\n  const [_value, setValue] = useUncontrolled({\n    value,\n    defaultValue,\n    finalValue: '',\n    rule: (val) => !!val && val.trim().length > 0,\n    onChange,\n  });\n\n  const handleInputFocus = (event: React.FocusEvent<HTMLInputElement>) => {\n    typeof onFocus === 'function' && onFocus(event);\n    setDropdownOpened(true);\n  };\n\n  const handleInputBlur = (event: React.FocusEvent<HTMLInputElement>) => {\n    typeof onBlur === 'function' && onBlur(event);\n    setDropdownOpened(false);\n    fixOnBlur && setValue(lastValidValue);\n  };\n\n  useEffect(() => {\n    if (isColorValid(_value)) {\n      setLastValidValue(_value);\n    }\n  }, [_value]);\n\n  useDidUpdate(() => {\n    if (isColorValid(_value)) {\n      setValue(convertHsvaTo(format, parseColor(_value)));\n    }\n  }, [format]);\n\n  return (\n    <InputWrapper\n      label={label}\n      description={description}\n      error={error}\n      required={required}\n      classNames={classNames}\n      styles={styles}\n      size={size}\n      id={uuid}\n      className={className}\n      style={style}\n      __staticSelector=\"color-input\"\n      {...wrapperProps}\n    >\n      <div ref={setReferenceElement}>\n        <Input<'input'>\n          {...others}\n          __staticSelector=\"color-input\"\n          id={uuid}\n          onFocus={handleInputFocus}\n          onBlur={handleInputBlur}\n          spellCheck={false}\n          size={size}\n          value={_value}\n          onChange={(event) => setValue(event.currentTarget.value)}\n          invalid={!!error}\n          required={required}\n          icon={\n            icon ||\n            (withPreview ? (\n              <ColorSwatch\n                color={isColorValid(_value) ? _value : '#fff'}\n                size={getSizeValue({ size, sizes: SWATCH_SIZES })}\n              />\n            ) : null)\n          }\n          readOnly={disallowInput}\n          classNames={classNames}\n          styles={{\n            ...styles,\n            input: { ...styles?.input, cursor: disallowInput ? 'pointer' : undefined },\n          }}\n        />\n      </div>\n\n      <Popper\n        referenceElement={referenceElement}\n        transitionDuration={useReducedMotion() ? 0 : transitionDuration}\n        transitionTimingFunction={transitionTimingFunction}\n        transition={transition}\n        mounted={dropdownOpened}\n        position=\"bottom\"\n        placement=\"start\"\n        gutter={5}\n        withArrow\n        arrowSize={3}\n        zIndex={dropdownZIndex}\n        arrowClassName={classes.arrow}\n        arrowStyle={{ ..._styles.arrow, left: getSizeValue({ size, sizes: ARROW_OFFSET }) }}\n      >\n        <div style={{ pointerEvents: 'all' }}>\n          <Paper\n            shadow=\"sm\"\n            padding={size}\n            className={classes.dropdownBody}\n            onMouseDown={(event) => event.preventDefault()}\n          >\n            <ColorPicker\n              __staticSelector=\"color-input\"\n              value={_value}\n              onChange={setValue}\n              format={format}\n              swatches={swatches}\n              swatchesPerRow={swatchesPerRow}\n              withPicker={withPicker}\n              size={size}\n              focusable={false}\n            />\n          </Paper>\n        </div>\n      </Popper>\n    </InputWrapper>\n  );\n}\n\nColorInput.displayName = '@mantine/core/ColorInput';\n"],"names":["useMantineTheme","useStyles","mergeStyles","useId","useState","useUncontrolled","useEffect","isColorValid","useDidUpdate","convertHsvaTo","parseColor","React","InputWrapper","Input","ColorSwatch","getSizeValue","Popper","useReducedMotion","Paper","ColorPicker"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAI,SAAS,GAAG,MAAM,CAAC,cAAc,CAAC;AACtC,IAAI,UAAU,GAAG,MAAM,CAAC,gBAAgB,CAAC;AACzC,IAAI,iBAAiB,GAAG,MAAM,CAAC,yBAAyB,CAAC;AACzD,IAAI,mBAAmB,GAAG,MAAM,CAAC,qBAAqB,CAAC;AACvD,IAAI,YAAY,GAAG,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC;AACnD,IAAI,YAAY,GAAG,MAAM,CAAC,SAAS,CAAC,oBAAoB,CAAC;AACzD,IAAI,eAAe,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,KAAK,KAAK,GAAG,IAAI,GAAG,GAAG,SAAS,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,UAAU,EAAE,IAAI,EAAE,YAAY,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC,GAAG,GAAG,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;AAChK,IAAI,cAAc,GAAG,CAAC,CAAC,EAAE,CAAC,KAAK;AAC/B,EAAE,KAAK,IAAI,IAAI,IAAI,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC;AAChC,IAAI,IAAI,YAAY,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC;AAClC,MAAM,eAAe,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;AACxC,EAAE,IAAI,mBAAmB;AACzB,IAAI,KAAK,IAAI,IAAI,IAAI,mBAAmB,CAAC,CAAC,CAAC,EAAE;AAC7C,MAAM,IAAI,YAAY,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC;AACpC,QAAQ,eAAe,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;AAC1C,KAAK;AACL,EAAE,OAAO,CAAC,CAAC;AACX,CAAC,CAAC;AACF,IAAI,aAAa,GAAG,CAAC,CAAC,EAAE,CAAC,KAAK,UAAU,CAAC,CAAC,EAAE,iBAAiB,CAAC,CAAC,CAAC,CAAC,CAAC;AAClE,IAAI,SAAS,GAAG,CAAC,MAAM,EAAE,OAAO,KAAK;AACrC,EAAE,IAAI,MAAM,GAAG,EAAE,CAAC;AAClB,EAAE,KAAK,IAAI,IAAI,IAAI,MAAM;AACzB,IAAI,IAAI,YAAY,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC;AACpE,MAAM,MAAM,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC;AAClC,EAAE,IAAI,MAAM,IAAI,IAAI,IAAI,mBAAmB;AAC3C,IAAI,KAAK,IAAI,IAAI,IAAI,mBAAmB,CAAC,MAAM,CAAC,EAAE;AAClD,MAAM,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,YAAY,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC;AACtE,QAAQ,MAAM,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC;AACpC,KAAK;AACL,EAAE,OAAO,MAAM,CAAC;AAChB,CAAC,CAAC;AAgBF,MAAM,YAAY,GAAG;AACrB,EAAE,EAAE,EAAE,EAAE;AACR,EAAE,EAAE,EAAE,EAAE;AACR,EAAE,EAAE,EAAE,EAAE;AACR,EAAE,EAAE,EAAE,EAAE;AACR,EAAE,EAAE,EAAE,EAAE;AACR,CAAC,CAAC;AACF,MAAM,YAAY,GAAG;AACrB,EAAE,EAAE,EAAE,EAAE;AACR,EAAE,EAAE,EAAE,EAAE;AACR,EAAE,EAAE,EAAE,EAAE;AACR,EAAE,EAAE,EAAE,EAAE;AACR,EAAE,EAAE,EAAE,EAAE;AACR,CAAC,CAAC;AACK,SAAS,UAAU,CAAC,EAAE,EAAE;AAC/B,EAAE,IAAI,EAAE,GAAG,EAAE,EAAE;AACf,IAAI,KAAK;AACT,IAAI,WAAW;AACf,IAAI,KAAK;AACT,IAAI,QAAQ;AACZ,IAAI,YAAY;AAChB,IAAI,IAAI,GAAG,IAAI;AACf,IAAI,MAAM,GAAG,KAAK;AAClB,IAAI,QAAQ;AACZ,IAAI,OAAO;AACX,IAAI,MAAM;AACV,IAAI,KAAK;AACT,IAAI,YAAY;AAChB,IAAI,UAAU;AACd,IAAI,MAAM;AACV,IAAI,aAAa;AACjB,IAAI,aAAa,GAAG,KAAK;AACzB,IAAI,SAAS,GAAG,IAAI;AACpB,IAAI,WAAW,GAAG,IAAI;AACtB,IAAI,cAAc,GAAG,EAAE;AACvB,IAAI,UAAU,GAAG,IAAI;AACrB,IAAI,IAAI;AACR,IAAI,UAAU,GAAG,cAAc;AAC/B,IAAI,EAAE;AACN,IAAI,cAAc,GAAG,CAAC;AACtB,IAAI,kBAAkB,GAAG,CAAC;AAC1B,IAAI,wBAAwB;AAC5B,IAAI,SAAS;AACb,IAAI,KAAK;AACT,IAAI,QAAQ;AACZ,GAAG,GAAG,EAAE,EAAE,MAAM,GAAG,SAAS,CAAC,EAAE,EAAE;AACjC,IAAI,OAAO;AACX,IAAI,aAAa;AACjB,IAAI,OAAO;AACX,IAAI,UAAU;AACd,IAAI,cAAc;AAClB,IAAI,MAAM;AACV,IAAI,QAAQ;AACZ,IAAI,UAAU;AACd,IAAI,SAAS;AACb,IAAI,QAAQ;AACZ,IAAI,OAAO;AACX,IAAI,cAAc;AAClB,IAAI,YAAY;AAChB,IAAI,QAAQ;AACZ,IAAI,eAAe;AACnB,IAAI,eAAe;AACnB,IAAI,WAAW;AACf,IAAI,aAAa;AACjB,IAAI,gBAAgB;AACpB,IAAI,YAAY;AAChB,IAAI,MAAM;AACV,IAAI,YAAY;AAChB,IAAI,IAAI;AACR,IAAI,gBAAgB;AACpB,IAAI,oBAAoB;AACxB,IAAI,0BAA0B;AAC9B,IAAI,WAAW;AACf,IAAI,OAAO;AACX,IAAI,UAAU;AACd,GAAG,CAAC,CAAC;AACL,EAAE,MAAM,KAAK,GAAGA,+BAAe,CAAC,aAAa,CAAC,CAAC;AAC/C,EAAE,MAAM,OAAO,GAAGC,4BAAS,CAAC,EAAE,KAAK,EAAE,EAAE,UAAU,EAAE,aAAa,CAAC,CAAC;AAClE,EAAE,MAAM,OAAO,GAAGC,uBAAW,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;AAC/C,EAAE,MAAM,IAAI,GAAGC,WAAK,CAAC,EAAE,CAAC,CAAC;AACzB,EAAE,MAAM,CAAC,gBAAgB,EAAE,mBAAmB,CAAC,GAAGC,cAAQ,CAAC,IAAI,CAAC,CAAC;AACjE,EAAE,MAAM,CAAC,cAAc,EAAE,iBAAiB,CAAC,GAAGA,cAAQ,CAAC,KAAK,CAAC,CAAC;AAC9D,EAAE,MAAM,CAAC,cAAc,EAAE,iBAAiB,CAAC,GAAGA,cAAQ,CAAC,EAAE,CAAC,CAAC;AAC3D,EAAE,MAAM,CAAC,MAAM,EAAE,QAAQ,CAAC,GAAGC,qBAAe,CAAC;AAC7C,IAAI,KAAK;AACT,IAAI,YAAY;AAChB,IAAI,UAAU,EAAE,EAAE;AAClB,IAAI,IAAI,EAAE,CAAC,GAAG,KAAK,CAAC,CAAC,GAAG,IAAI,GAAG,CAAC,IAAI,EAAE,CAAC,MAAM,GAAG,CAAC;AACjD,IAAI,QAAQ;AACZ,GAAG,CAAC,CAAC;AACL,EAAE,MAAM,gBAAgB,GAAG,CAAC,KAAK,KAAK;AACtC,IAAI,OAAO,OAAO,KAAK,UAAU,IAAI,OAAO,CAAC,KAAK,CAAC,CAAC;AACpD,IAAI,iBAAiB,CAAC,IAAI,CAAC,CAAC;AAC5B,GAAG,CAAC;AACJ,EAAE,MAAM,eAAe,GAAG,CAAC,KAAK,KAAK;AACrC,IAAI,OAAO,MAAM,KAAK,UAAU,IAAI,MAAM,CAAC,KAAK,CAAC,CAAC;AAClD,IAAI,iBAAiB,CAAC,KAAK,CAAC,CAAC;AAC7B,IAAI,SAAS,IAAI,QAAQ,CAAC,cAAc,CAAC,CAAC;AAC1C,GAAG,CAAC;AACJ,EAAEC,eAAS,CAAC,MAAM;AAClB,IAAI,IAAIC,oBAAY,CAAC,MAAM,CAAC,EAAE;AAC9B,MAAM,iBAAiB,CAAC,MAAM,CAAC,CAAC;AAChC,KAAK;AACL,GAAG,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;AACf,EAAEC,kBAAY,CAAC,MAAM;AACrB,IAAI,IAAID,oBAAY,CAAC,MAAM,CAAC,EAAE;AAC9B,MAAM,QAAQ,CAACE,wBAAa,CAAC,MAAM,EAAEC,kBAAU,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;AAC1D,KAAK;AACL,GAAG,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;AACf,EAAE,uBAAuBC,cAAK,CAAC,aAAa,CAACC,yBAAY,EAAE,cAAc,CAAC;AAC1E,IAAI,KAAK;AACT,IAAI,WAAW;AACf,IAAI,KAAK;AACT,IAAI,QAAQ;AACZ,IAAI,UAAU;AACd,IAAI,MAAM;AACV,IAAI,IAAI;AACR,IAAI,EAAE,EAAE,IAAI;AACZ,IAAI,SAAS;AACb,IAAI,KAAK;AACT,IAAI,gBAAgB,EAAE,aAAa;AACnC,GAAG,EAAE,YAAY,CAAC,kBAAkBD,cAAK,CAAC,aAAa,CAAC,KAAK,EAAE;AAC/D,IAAI,GAAG,EAAE,mBAAmB;AAC5B,GAAG,kBAAkBA,cAAK,CAAC,aAAa,CAACE,WAAK,EAAE,aAAa,CAAC,cAAc,CAAC,EAAE,EAAE,MAAM,CAAC,EAAE;AAC1F,IAAI,gBAAgB,EAAE,aAAa;AACnC,IAAI,EAAE,EAAE,IAAI;AACZ,IAAI,OAAO,EAAE,gBAAgB;AAC7B,IAAI,MAAM,EAAE,eAAe;AAC3B,IAAI,UAAU,EAAE,KAAK;AACrB,IAAI,IAAI;AACR,IAAI,KAAK,EAAE,MAAM;AACjB,IAAI,QAAQ,EAAE,CAAC,KAAK,KAAK,QAAQ,CAAC,KAAK,CAAC,aAAa,CAAC,KAAK,CAAC;AAC5D,IAAI,OAAO,EAAE,CAAC,CAAC,KAAK;AACpB,IAAI,QAAQ;AACZ,IAAI,IAAI,EAAE,IAAI,KAAK,WAAW,mBAAmBF,cAAK,CAAC,aAAa,CAACG,uBAAW,EAAE;AAClF,MAAM,KAAK,EAAEP,oBAAY,CAAC,MAAM,CAAC,GAAG,MAAM,GAAG,MAAM;AACnD,MAAM,IAAI,EAAEQ,yBAAY,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,YAAY,EAAE,CAAC;AACvD,KAAK,CAAC,GAAG,IAAI,CAAC;AACd,IAAI,QAAQ,EAAE,aAAa;AAC3B,IAAI,UAAU;AACd,IAAI,MAAM,EAAE,aAAa,CAAC,cAAc,CAAC,EAAE,EAAE,MAAM,CAAC,EAAE;AACtD,MAAM,KAAK,EAAE,aAAa,CAAC,cAAc,CAAC,EAAE,EAAE,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,GAAG,MAAM,CAAC,KAAK,CAAC,EAAE,EAAE,MAAM,EAAE,aAAa,GAAG,SAAS,GAAG,KAAK,CAAC,EAAE,CAAC;AACtI,KAAK,CAAC;AACN,GAAG,CAAC,CAAC,CAAC,kBAAkBJ,cAAK,CAAC,aAAa,CAACK,aAAM,EAAE;AACpD,IAAI,gBAAgB;AACpB,IAAI,kBAAkB,EAAEC,sBAAgB,EAAE,GAAG,CAAC,GAAG,kBAAkB;AACnE,IAAI,wBAAwB;AAC5B,IAAI,UAAU;AACd,IAAI,OAAO,EAAE,cAAc;AAC3B,IAAI,QAAQ,EAAE,QAAQ;AACtB,IAAI,SAAS,EAAE,OAAO;AACtB,IAAI,MAAM,EAAE,CAAC;AACb,IAAI,SAAS,EAAE,IAAI;AACnB,IAAI,SAAS,EAAE,CAAC;AAChB,IAAI,MAAM,EAAE,cAAc;AAC1B,IAAI,cAAc,EAAE,OAAO,CAAC,KAAK;AACjC,IAAI,UAAU,EAAE,aAAa,CAAC,cAAc,CAAC,EAAE,EAAE,OAAO,CAAC,KAAK,CAAC,EAAE,EAAE,IAAI,EAAEF,yBAAY,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,YAAY,EAAE,CAAC,EAAE,CAAC;AACvH,GAAG,kBAAkBJ,cAAK,CAAC,aAAa,CAAC,KAAK,EAAE;AAChD,IAAI,KAAK,EAAE,EAAE,aAAa,EAAE,KAAK,EAAE;AACnC,GAAG,kBAAkBA,cAAK,CAAC,aAAa,CAACO,WAAK,EAAE;AAChD,IAAI,MAAM,EAAE,IAAI;AAChB,IAAI,OAAO,EAAE,IAAI;AACjB,IAAI,SAAS,EAAE,OAAO,CAAC,YAAY;AACnC,IAAI,WAAW,EAAE,CAAC,KAAK,KAAK,KAAK,CAAC,cAAc,EAAE;AAClD,GAAG,kBAAkBP,cAAK,CAAC,aAAa,CAACQ,uBAAW,EAAE;AACtD,IAAI,gBAAgB,EAAE,aAAa;AACnC,IAAI,KAAK,EAAE,MAAM;AACjB,IAAI,QAAQ,EAAE,QAAQ;AACtB,IAAI,MAAM;AACV,IAAI,QAAQ;AACZ,IAAI,cAAc;AAClB,IAAI,UAAU;AACd,IAAI,IAAI;AACR,IAAI,SAAS,EAAE,KAAK;AACpB,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACT,CAAC;AACD,UAAU,CAAC,WAAW,GAAG,0BAA0B;;;;"}