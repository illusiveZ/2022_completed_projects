{"version":3,"file":"focus-manager.js","sources":["../../src/use-focus-trap/focus-manager.ts"],"sourcesContent":["import { findTabbableDescendants } from './tabbable';\n\nconst focusLaterElements: HTMLElement[] = [];\nlet focusElement: HTMLElement = null;\nlet needToFocus = false;\n\nfunction handleBlur() {\n  needToFocus = true;\n}\n\nfunction handleFocus() {\n  if (needToFocus) {\n    needToFocus = false;\n\n    if (!focusElement) {\n      return;\n    }\n\n    if (!focusElement) {\n      return;\n    }\n\n    if (focusElement.contains(document.activeElement)) {\n      return;\n    }\n\n    const el = findTabbableDescendants(focusElement)[0] || focusElement;\n    el.focus();\n  }\n}\n\nexport function markForFocusLater() {\n  focusLaterElements.push(document.activeElement as HTMLElement);\n}\n\nexport function returnFocus() {\n  let toFocus = null;\n  try {\n    toFocus = focusLaterElements.pop();\n    if (toFocus) toFocus.focus();\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.warn(\n      [\n        '[@mantine/hooks/use-focus-trap] Focus was returned to',\n        toFocus,\n        'but dom node does not exist',\n      ].join(' ')\n    );\n  }\n}\n\nexport function setupScopedFocus(element: HTMLElement) {\n  focusElement = element;\n  document.addEventListener('focusout', handleBlur, false);\n  document.addEventListener('focusin', handleFocus, true);\n}\n\nexport function teardownScopedFocus() {\n  focusElement = null;\n  document.removeEventListener('focusout', handleBlur);\n  document.removeEventListener('focusin', handleFocus);\n}\n"],"names":["findTabbableDescendants"],"mappings":";;;;;;AACA,MAAM,kBAAkB,GAAG,EAAE,CAAC;AAC9B,IAAI,YAAY,GAAG,IAAI,CAAC;AACxB,IAAI,WAAW,GAAG,KAAK,CAAC;AACxB,SAAS,UAAU,GAAG;AACtB,EAAE,WAAW,GAAG,IAAI,CAAC;AACrB,CAAC;AACD,SAAS,WAAW,GAAG;AACvB,EAAE,IAAI,WAAW,EAAE;AACnB,IAAI,WAAW,GAAG,KAAK,CAAC;AACxB,IAAI,IAAI,CAAC,YAAY,EAAE;AACvB,MAAM,OAAO;AACb,KAAK;AACL,IAAI,IAAI,CAAC,YAAY,EAAE;AACvB,MAAM,OAAO;AACb,KAAK;AACL,IAAI,IAAI,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,aAAa,CAAC,EAAE;AACvD,MAAM,OAAO;AACb,KAAK;AACL,IAAI,MAAM,EAAE,GAAGA,gCAAuB,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,IAAI,YAAY,CAAC;AACxE,IAAI,EAAE,CAAC,KAAK,EAAE,CAAC;AACf,GAAG;AACH,CAAC;AACM,SAAS,iBAAiB,GAAG;AACpC,EAAE,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;AAClD,CAAC;AACM,SAAS,WAAW,GAAG;AAC9B,EAAE,IAAI,OAAO,GAAG,IAAI,CAAC;AACrB,EAAE,IAAI;AACN,IAAI,OAAO,GAAG,kBAAkB,CAAC,GAAG,EAAE,CAAC;AACvC,IAAI,IAAI,OAAO;AACf,MAAM,OAAO,CAAC,KAAK,EAAE,CAAC;AACtB,GAAG,CAAC,OAAO,CAAC,EAAE;AACd,IAAI,OAAO,CAAC,IAAI,CAAC;AACjB,MAAM,uDAAuD;AAC7D,MAAM,OAAO;AACb,MAAM,6BAA6B;AACnC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;AACjB,GAAG;AACH,CAAC;AACM,SAAS,gBAAgB,CAAC,OAAO,EAAE;AAC1C,EAAE,YAAY,GAAG,OAAO,CAAC;AACzB,EAAE,QAAQ,CAAC,gBAAgB,CAAC,UAAU,EAAE,UAAU,EAAE,KAAK,CAAC,CAAC;AAC3D,EAAE,QAAQ,CAAC,gBAAgB,CAAC,SAAS,EAAE,WAAW,EAAE,IAAI,CAAC,CAAC;AAC1D,CAAC;AACM,SAAS,mBAAmB,GAAG;AACtC,EAAE,YAAY,GAAG,IAAI,CAAC;AACtB,EAAE,QAAQ,CAAC,mBAAmB,CAAC,UAAU,EAAE,UAAU,CAAC,CAAC;AACvD,EAAE,QAAQ,CAAC,mBAAmB,CAAC,SAAS,EAAE,WAAW,CAAC,CAAC;AACvD;;;;;;;"}